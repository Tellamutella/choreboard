<div class="container all-tasks">
    <div class="text-center">
        <%= image_tag 'choreslist.png', height: 70 %>
    </div>
    <h4><%= icon('fas', 'chevron-right') %> Today's Quests:</h4>
    <ul class="task-list">
        <% @tasks.select(&:mandatory).each do |task| %>
        <li>
            <div class="task-name">
                <%= task.objective.capitalize %>
            </div>
            <div class="task-details">
                <h5>You will need to:</h5>
                <p>
                    <%= task.key_results %>
                </p>
                <hr>
                <% if task.task_submissions.any? %>
                <div>(Last submission status:
                <%= task.task_submissions.last.state %>)</div>
                <% end %>
                <%= link_to new_task_task_submission_path(task) do %>
                Make a submission
                <% end %>
            </div>
        </li>
        <% end %>
    </ul>
    <br>
    <h4><%= icon('fas', 'chevron-right') %> Ultimate Tasks:</h4>
    <ul>
        <% @tasks.reject(&:mandatory).each do |task| %>
        <li>
            <h5><%= task.objective.capitalize %></h5>
            <div class="task-details">
                <p>
                    <%= task.key_results %>
                </p>
                <%= link_to new_task_task_submission_path(task) do %>
                Make a submission
                <% end %>
            </div>
        </li>
        <% end %>
    </ul>
</div>
<!------------------>
<script>
const tasks = document.querySelectorAll(".task-name");
tasks.forEach(task => {
    task.addEventListener('click', event => {
        event.target.nextElementSibling.classList.toggle("visible-task-details");
        event.target.classList.toggle("active-task");
    })
})
</script>
